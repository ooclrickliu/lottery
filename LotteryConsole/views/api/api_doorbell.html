<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Apis</title>
    <link rel="stylesheet" href="../../public/css/bootstrap.min.css" type="text/css"/>
    <link rel="stylesheet" href="../../public/css/font-awesome.min.css" type="text/css"/>
    <link rel="stylesheet" href="../../public/css/font.css" type="text/css"/>
    <link rel="stylesheet" href="../../public/css/simple-line-icons.css" type="text/css"/>
    <link rel="stylesheet" href="../../css/app.css" type="text/css"/>
    <style>
        .table {
            margin-bottom: 0;
        }
        .table td {
            text-align: center;
        }
        .table-bordered {
            border: none;
        }
        .table-bordered > tbody > tr > td {
            border-color: #ccc;
        }
        .table-bordered > thead > tr > th {
            border: none;
        }
    </style>
</head>
<body>
<div ng-app="myapp" ng-controller="myController" class="wrapper" id="top">
    <section id="apis">
        <h4 class="page-header">
            <a class="text-2x">Doorbell API</a>
            <a class="text-info" href="#errCodes">Doorbell Error Codes</a>
        </h4>
        <table class="table table-bordered">
            <thead class="bg-info">
            <tr>
                <th class="text-center" width="250px" >URL</th>
                <th class="text-center" width="100px" >Method</th>
                <th class="text-center" width="100px"  >模块</th>
                <th class="text-center" width="300px"  >描述</th>
                <th class="text-center" width="350px">参数</th>
                <th class="text-center" width="500px">返回参数
                    <a class="btn btn-xs btn-info dker pull-right"
                       ng-click="showAllParamsDetail()">{{isShowAllParamsDetail ? '收起所有' : '展开所有'}}
                    </a>
                </th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="data in apiDatas">
                <td class="v-middle"  width="250px">{{data.url}}</td>
                <td class="v-middle text-center" width="100px" >{{data.method}}</td>
                <td class="v-middle text-center" width="100px" >{{data.category}}</td>
                <td class="v-middle text-center" width="300px" >{{data.description}}</td>
                <td class="v-middle text-center" width="350px">
                    <div ng-show="data.parameters.length > 0">
                        <div>
                            <label>
                                <span ng-repeat="parameter in data.parameters">
                                 [ {{parameter.name}} ]&nbsp;
                                </span>
                            </label>
                        </div>
                        <div class="line b-b" ng-show="data.showParamsDetail"></div>
                        <table class="table table-bordered"
                               ng-show="data.parameters.length > 0 && data.showParamsDetail">
                            <thead class="bg-light lter">
                            <tr class="text-center">
                                <td >参数名</td>
                                <td >参数描述</td>
                                <td >是否必需</td>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="parameter in data.parameters">
                                <td >{{parameter.name}}</td>
                                <td>{{parameter.description}}</td>
                                <td class="text-center">{{parameter.required == "false" ? "否" : "是"}}</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </td>
                <td class="text-limit text-ellipsis" width="500px">response
                        <i class="fa text-lg pull-right"
                           ng-class="{true:'fa-angle-double-down', false:'fa-angle-double-up'}[!data.showParamsDetail]"
                           ng-click="data.showParamsDetail = !data.showParamsDetail"></i>
                    <pre ng-show="data.showParamsDetail">{{data.response |filter:","}}</pre>
                </td>
            </tr>
            </tbody>
        </table>
    </section>
    <section id="errCodes">
        <h4 class="page-header">
            <a class="text-2x">Doorbell Error Codes</a>
            |
            <a class="text-info" href="#apis">Doorbell API</a>
        </h4>
        <table class="table table-bordered">
            <thead class="bg-info">
            <tr>
                <th class="text-center" width="20%">错误码</th>
                <th class="text-center" width="5%">类别</th>
                <th class="text-center" width="7%">说明</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="errCode in errCodeDatas">
                <td class="v-middle" width="40%">{{errCode.name}}</td>
                <td class="v-middle text-center" width="20%">{{errCode.type}}</td>
                <td class="v-middle" width="40%">{{errCode.description}}</td>
            </tr>
            </tbody>
        </table>
    </section>
    <a id="goTopHint" class="wrapper-sm bg-light pos-fix" href="#top" style="bottom: 10px; right:18px; display: none">返回顶部
        <i class="fa fa-angle-up"></i>
    </a>
</div>
<script src="../../public/js/jquery/jquery.min.js"></script>
<script src="../../public/js/jquery/bootstrap.min.js"></script>
<script src="../../public/js/angular/angular.js"></script>
<script>
    var scrollFunc = function (e) {
        if (document.body.scrollTop > 600) {
            jQuery("#goTopHint").show();
        } else {
            jQuery("#goTopHint").hide();
        }
    };
    if (document.addEventListener) {
        document.addEventListener("DOMMouseScroll", scrollFunc, false);
    }
    window.onmousewheel = document.onmousewheel = scrollFunc;
</script>
<script>
    angular.module('myapp', []).controller('myController', ['$scope', '$http', function ($scope, $http) {
        $scope.isShowAllParamsDetail = false;
        $scope.apiDatas = {};
        $http.get("../../resource/json/DoorbellPaymentApi.json").success(function (response) {
            $scope.apiDatas = response;
            for (var i = 0; i < $scope.apiDatas.length; i++) {
                $scope.apiDatas[i].showParamsDetail = false;
            }
        });
        $http.get("../../resource/json/DoorbellErrorCode.json").success(function (response) {
            $scope.errCodeDatas = response;
        });
        $scope.showAllParamsDetail = function () {
            if ($scope.isShowAllParamsDetail) {
                for (var i = 0; i < $scope.apiDatas.length; i++) {
                    $scope.apiDatas[i].showParamsDetail = false;
                }
                $scope.isShowAllParamsDetail = false;
            } else {
                for (var i = 0; i < $scope.apiDatas.length; i++) {
                    $scope.apiDatas[i].showParamsDetail = true;
                }
                $scope.isShowAllParamsDetail = true;
            }
        };
    }]);
</script>
</body>
</html>
